{"status":"success","errors":null,"data":{"endTime":100,"readOnlyCode":true,"stateUploadIntervalMillis":2000,"maxReplicatesRun":1000,"maxReplicatesDisplay":50,"appType":"stochastic","title":"Stochasticity: Growth and death","help":{"tabName":"Explanation","markdown":["## Example 2: Stochastic growth and death model","","This model includes births and deaths at per-capita rates $r$ and $s$ per week, respectively. The ODE for $N$ is made up of the difference between the mean growth rate and the mean death rate:","","$$ \\frac{dN}{dt}=rN-sN $$","","The difference $(r-s)$ is the net growth rate and the solution is either exponential growth or decline i.e.,","","$$ N(t) =N(0) \\exp((r-s)t) $$","","If births exceed deaths ($r > s$) the population grows. If deaths exceed births ($s > r$) the population shrinks.","","In the stochastic simulation, we have to be more careful as we are dealing with individuals. Each individual has a probability of reproducing and of dying in some short interval, $dt$. However, it canâ€™t die and then give birth! These two dependent events that can happen are known as competing hazards. To calculate the number of births and deaths in a short time, we first calculate the number of births or deaths:","","$$ \\mbox{Births or deaths in }dt, n \\sim \\mathrm{Binomial}(N,(r + s)dt) $$","","We then decide which were births and which deaths:","","$$ \\mbox{Deaths in }dt \\sim \\mathrm{Binomial}(s / (r + s),n) $$",""]},"defaultCode":["r <- user(0.1)    # Growth rate","s <- user(0.06)   # Death rate","N_init <- user(1) # Initial population size","","dt <- 0.01","time <- step * dt","","# Deterministic solution - often unobtainable for non-linear models","initial(N_det) <- N_init","update(N_det) <- N_init * exp((r - s) * time)","","# Stochastic solution with initial condition, number of births in time","# t to t + dt and then update to next step","","initial(N) <- N_init","","# How many events happen in total (births and deaths)?","growthAndDeath <- rbinom(N, (r + s) * dt)","","# How many of these events were deaths?","death <- rbinom(growthAndDeath, s / (r + s))","growth <- growthAndDeath - death","","update(N) <- N + growth - death","","# Track if the population has gone extinct:","initial(extinct) <- N == 0","update(extinct) <- N == 0",""]}}